

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>src.gui.main.expt_editor &mdash; Transport Experiment 1.5.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="Transport Experiment 1.5.0 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Transport Experiment 1.5.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for src.gui.main.expt_editor</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;A general frame for creating and editing experiments.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">cPickle</span> <span class="kn">as</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">wx</span>

<span class="kn">from</span> <span class="nn">src.core</span> <span class="kn">import</span> <span class="n">progress</span>
<span class="kn">from</span> <span class="nn">src.core.action</span> <span class="kn">import</span> <span class="n">constructAction</span>
<span class="kn">from</span> <span class="nn">src.core.errors</span> <span class="kn">import</span> <span class="n">InstrumentInUseError</span>
<span class="kn">from</span> <span class="nn">src.core.graph</span> <span class="kn">import</span> <span class="n">Graph</span>
<span class="kn">from</span> <span class="nn">src.core.inst_manager</span> <span class="kn">import</span> <span class="n">INSTRUMENT_MANAGER</span>
<span class="kn">from</span> <span class="nn">src.gui</span> <span class="kn">import</span> <span class="n">gui_helpers</span> <span class="k">as</span> <span class="n">gh</span>
<span class="kn">from</span> <span class="nn">src.gui</span> <span class="kn">import</span> <span class="n">images</span> <span class="k">as</span> <span class="n">img</span>
<span class="kn">from</span> <span class="nn">src.gui</span> <span class="kn">import</span> <span class="n">object_config</span> <span class="k">as</span> <span class="n">oc</span>
<span class="kn">from</span> <span class="nn">src.gui.main.base_experiment</span> <span class="kn">import</span> <span class="p">(</span><span class="n">ExperimentFrame</span><span class="p">,</span>
                                          <span class="n">ID_INSTRUMENTS</span><span class="p">,</span> <span class="n">ID_CONSTANTS</span><span class="p">,</span>
                                          <span class="n">ID_GRAPHS</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">src.gui.main.status_frame</span> <span class="kn">import</span> <span class="n">StatusMonitorFrame</span>
<span class="kn">from</span> <span class="nn">src.gui.object_config</span> <span class="kn">import</span> <span class="n">GraphDialog</span>
<span class="kn">from</span> <span class="nn">src.gui.object_config</span> <span class="kn">import</span> <span class="n">InstrumentDialog</span>
<span class="kn">from</span> <span class="nn">src.tools</span> <span class="kn">import</span> <span class="n">path_tools</span> <span class="k">as</span> <span class="n">pt</span>
<span class="kn">from</span> <span class="nn">src.tools.general</span> <span class="kn">import</span> <span class="n">Command</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;transport&#39;</span><span class="p">)</span>

<span class="n">_DEFAULT_OPTIONS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TR_NO_BUTTONS</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_HIDE_ROOT</span> <span class="o">|</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">TR_FULL_ROW_HIGHLIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_SINGLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_NO_LINES</span><span class="p">)</span>
<span class="n">_INDENT</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">_MIN_SIDE_WIDTH</span> <span class="o">=</span> <span class="mi">180</span>

<span class="n">_ID_REBIND</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
<span class="n">_ID_ENABLE</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
<span class="n">_ID_INTERRUPT</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>

<span class="n">_PRINT_SEQUENCE</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">SetupFrames</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;SetupFrames&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;instruments&#39;</span><span class="p">,</span> <span class="s">&#39;constants&#39;</span><span class="p">,</span> <span class="s">&#39;graphs&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="SequenceFrame"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame">[docs]</a><span class="k">class</span> <span class="nc">SequenceFrame</span><span class="p">(</span><span class="n">ExperimentFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A frame for creating general experiments.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : Transport</span>
<span class="sd">        The main Transport program frame (or anything which implements the</span>
<span class="sd">        same interface).</span>
<span class="sd">    experiment : Experiment</span>
<span class="sd">        The `Experiment` object which this frame edits.</span>
<span class="sd">    sourceDefault : bool</span>
<span class="sd">        Whether the sequence should be populated with the default items.</span>
<span class="sd">    title : str</span>
<span class="sd">        The title of the experiment.</span>
<span class="sd">    experimentPath : str</span>
<span class="sd">        The path to the experiment, if it was opened from a file. The default</span>
<span class="sd">        is `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">sourceDefault</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s">&#39;Experiment Editor&#39;</span><span class="p">,</span> <span class="n">experimentPath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SequenceFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span>
                                            <span class="n">experiment</span><span class="o">=</span><span class="n">experiment</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                            <span class="n">premade</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                            <span class="n">experimentPath</span><span class="o">=</span><span class="n">experimentPath</span><span class="p">,</span>
                                            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>

        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">mainpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">treepanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">,</span> <span class="s">&#39;Sequence&#39;</span><span class="p">,</span> <span class="n">extraBorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">ActionTree</span><span class="p">(</span><span class="n">treepanel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="n">parentFrame</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendControl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
        <span class="n">treepanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">sidepanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">instpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">sidepanel</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">,</span> <span class="s">&#39;Instruments&#39;</span><span class="p">,</span>
                             <span class="n">extraBorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">actionspanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">sidepanel</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">,</span> <span class="s">&#39;Actions&#39;</span><span class="p">,</span> <span class="n">extraBorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sidepanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">instpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sidepanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">actionspanel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">instpanel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendControl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">SetMinSize</span><span class="p">((</span><span class="n">_MIN_SIDE_WIDTH</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">instpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">actionspanel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendControl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">SetMinSize</span><span class="p">((</span><span class="n">_MIN_SIDE_WIDTH</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">actionspanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">treepanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sidepanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sourceDefault</span> <span class="o">=</span> <span class="n">sourceDefault</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceDefault</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">buildDefaultTree</span><span class="p">()</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="s">&#39;Item 0&#39;</span><span class="p">,</span> <span class="s">&#39;Result&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">addGraph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LIST_ITEM_FOCUSED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateActionDisplay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LIST_ITEM_ACTIVATED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LIST_BEGIN_DRAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beginDrag</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dropTarget</span> <span class="o">=</span> <span class="n">MyDropTarget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">SetDropTarget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropTarget</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__edited</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteButton</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyButton</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutButton</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extendMenus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extendToolbar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizerAndFit</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateInstrumentDisplay</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createSetupFrames</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateName</span><span class="p">()</span>

<div class="viewcode-block" id="SequenceFrame.extendMenus"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.extendMenus">[docs]</a>    <span class="k">def</span> <span class="nf">extendMenus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extend the menu bar with experiment editor-specific items.&quot;&quot;&quot;</span>

        <span class="c"># -- File Menu</span>
        <span class="n">fileAdder</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">gh</span><span class="o">.</span><span class="n">createMenuItem</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">)</span>
        <span class="n">fileAdder</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_SAVE</span><span class="p">,</span> <span class="s">&#39;Save&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSave</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">fileAdder</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_SAVEAS</span><span class="p">,</span> <span class="s">&#39;Save As&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSaveAs</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">editAdder</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">gh</span><span class="o">.</span><span class="n">createMenuItem</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutButton</span> <span class="o">=</span> <span class="n">editAdder</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CUT</span><span class="p">,</span> <span class="s">&#39;Cut&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">onCut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyButton</span> <span class="o">=</span> <span class="n">editAdder</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span><span class="p">,</span> <span class="s">&#39;Copy&#39;</span><span class="p">,</span>
                                    <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">onCopy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteButton</span> <span class="o">=</span> <span class="n">editAdder</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span><span class="p">,</span> <span class="s">&#39;Paste&#39;</span><span class="p">,</span>
                                     <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">onPaste</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">editAdder</span><span class="p">(</span><span class="n">ID_INSTRUMENTS</span><span class="p">,</span> <span class="s">&#39;Setup Instruments&#39;</span><span class="p">,</span>
                  <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSetupInstruments</span><span class="p">)</span>
        <span class="n">editAdder</span><span class="p">(</span><span class="n">ID_CONSTANTS</span><span class="p">,</span> <span class="s">&#39;Setup Constants&#39;</span><span class="p">,</span>
                  <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSetupConstants</span><span class="p">)</span>
        <span class="n">editAdder</span><span class="p">(</span><span class="n">ID_GRAPHS</span><span class="p">,</span> <span class="s">&#39;Setup Graphs&#39;</span><span class="p">,</span>
                  <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSetupGraphs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="s">&#39;Edit&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SequenceFrame.extendToolbar"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.extendToolbar">[docs]</a>    <span class="k">def</span> <span class="nf">extendToolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extend the toolbar with experiment editor-specific items.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">AddSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">AddSimpleTool</span><span class="p">(</span><span class="n">ID_INSTRUMENTS</span><span class="p">,</span>
                              <span class="n">img</span><span class="o">.</span><span class="n">getInstrumentsButtonBitmap</span><span class="p">(),</span>
                              <span class="s">&#39;Instruments&#39;</span><span class="p">,</span> <span class="s">&#39;Configure the instruments.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">AddSimpleTool</span><span class="p">(</span><span class="n">ID_CONSTANTS</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">getConstantsButtonBitmap</span><span class="p">(),</span>
                              <span class="s">&#39;Constants&#39;</span><span class="p">,</span> <span class="s">&#39;Edit constants.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">AddSimpleTool</span><span class="p">(</span><span class="n">ID_GRAPHS</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">getGraphsButtonBitmap</span><span class="p">(),</span>
                              <span class="s">&#39;Graphs&#39;</span><span class="p">,</span> <span class="s">&#39;Edit graphs.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">AddCheckTool</span><span class="p">(</span><span class="n">_ID_INTERRUPT</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">getInterruptBitmap</span><span class="p">(),</span>
                                   <span class="n">shortHelp</span><span class="o">=</span><span class="s">&#39;Interrupt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableInterrupt</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSetupInstruments</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">ID_INSTRUMENTS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSetupConstants</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">ID_CONSTANTS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSetupGraphs</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">ID_GRAPHS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onInterrupt</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">_ID_INTERRUPT</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span>

    <span class="c">#===========================================================================</span>
    <span class="c"># Edit flags</span>
    <span class="c">#===========================================================================</span>
</div>
<div class="viewcode-block" id="SequenceFrame.getEdited"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.getEdited">[docs]</a>    <span class="k">def</span> <span class="nf">getEdited</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether the experiment has been edited.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether the experiment has been edited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__edited</span></div>
<div class="viewcode-block" id="SequenceFrame.setEdited"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.setEdited">[docs]</a>    <span class="k">def</span> <span class="nf">setEdited</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newValue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set whether the experiment has been edited.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        newValue : bool</span>
<span class="sd">            Whether the experiment has been edited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__edited</span> <span class="o">=</span> <span class="n">newValue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateName</span><span class="p">()</span></div>
    <span class="n">edited</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getEdited</span><span class="p">,</span> <span class="n">setEdited</span><span class="p">)</span>
<div class="viewcode-block" id="SequenceFrame.flagEdit"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.flagEdit">[docs]</a>    <span class="k">def</span> <span class="nf">flagEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Indicate that the experiment has been edited.</span>
<span class="sd">        </span>
<span class="sd">        This is a simple shorthand for `self.edited = True`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edited</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="SequenceFrame.onRun"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.onRun">[docs]</a>    <span class="k">def</span> <span class="nf">onRun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the experiment.&quot;&quot;&quot;</span>
        <span class="n">smon</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">getStatusMonitor</span><span class="p">(</span><span class="s">&#39;main&#39;</span><span class="p">)</span>
        <span class="n">loopEnter</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_enableInterrupt</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">loopExit</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_enableInterrupt</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">setInteractionParameters</span><span class="p">(</span><span class="n">statusMonitor</span><span class="o">=</span><span class="n">smon</span><span class="p">,</span>
                                                 <span class="n">loopEnterCommands</span><span class="o">=</span><span class="p">[</span><span class="n">loopEnter</span><span class="p">],</span>
                                                 <span class="n">loopExitCommands</span><span class="o">=</span><span class="p">[</span><span class="n">loopExit</span><span class="p">])</span>
        <span class="n">statmon</span> <span class="o">=</span> <span class="n">StatusMonitorFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smon</span><span class="p">)</span>
        <span class="n">statmon</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="n">statmon</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experimentName</span> <span class="o">+</span> <span class="s">&#39; - Status Monitor&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SequenceFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">onRun</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">statmon</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SequenceFrame.updateInstrumentDisplay"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.updateInstrumentDisplay">[docs]</a>    <span class="k">def</span> <span class="nf">updateInstrumentDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the list of instruments.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">setItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrumentStrings</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">setSelection</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateActionDisplay</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SequenceFrame.updateActionDisplay"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.updateActionDisplay">[docs]</a>    <span class="k">def</span> <span class="nf">updateActionDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the list of actions for changes in selected instrument.&quot;&quot;&quot;</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">getSelection</span><span class="p">())</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">instrument</span><span class="o">.</span><span class="n">getActions</span><span class="p">()</span>
        <span class="n">actionStrings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">actionStrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">setItems</span><span class="p">(</span><span class="n">actionStrings</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SequenceFrame.updateExperimentDisplay"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.updateExperimentDisplay">[docs]</a>    <span class="k">def</span> <span class="nf">updateExperimentDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Refresh the sequence tree.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SequenceFrame.updateName"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.updateName">[docs]</a>    <span class="k">def</span> <span class="nf">updateName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newName</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the name of the experiment.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">newName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">newName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimentName</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edited</span><span class="p">:</span>
            <span class="n">newName</span> <span class="o">+=</span> <span class="s">&#39;*&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">newName</span> <span class="o">+</span> <span class="s">&#39; - Experiment Editor&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">instruments</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">newName</span> <span class="o">+</span> <span class="s">&#39; - Instruments&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">newName</span> <span class="o">+</span> <span class="s">&#39; - Constants&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">newName</span> <span class="o">+</span> <span class="s">&#39; - Graphs&#39;</span><span class="p">)</span>


    <span class="c">#-------------------------------------------------------------- Setup frames</span>
</div>
<div class="viewcode-block" id="SequenceFrame.createSetupFrames"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.createSetupFrames">[docs]</a>    <span class="k">def</span> <span class="nf">createSetupFrames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create frames for managing constants, instruments, and graphs.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">premade</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">command1</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateInstrumentDisplay</span><span class="p">)</span>
        <span class="n">command2</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateExperimentDisplay</span><span class="p">)</span>
        <span class="n">command3</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SetupFrames</span><span class="p">(</span>
                <span class="n">InstrumentFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span>
                                <span class="p">[</span><span class="n">command1</span><span class="p">,</span> <span class="n">command2</span><span class="p">,</span> <span class="n">command3</span><span class="p">]),</span>
                <span class="n">ConstantFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="p">[</span><span class="n">command3</span><span class="p">]),</span>
                <span class="n">GraphFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="p">[</span><span class="n">command3</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="SequenceFrame.onSetupInstruments"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.onSetupInstruments">[docs]</a>    <span class="k">def</span> <span class="nf">onSetupInstruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the instrument configuration tool.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">win</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">instruments</span>
            <span class="n">win</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SequenceFrame.onSetupConstants"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.onSetupConstants">[docs]</a>    <span class="k">def</span> <span class="nf">onSetupConstants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the constants configuration tool.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">win</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">constants</span>
            <span class="n">win</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SequenceFrame.onSetupGraphs"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.onSetupGraphs">[docs]</a>    <span class="k">def</span> <span class="nf">onSetupGraphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the graphs configuration tool.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">win</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupFrames</span><span class="o">.</span><span class="n">graphs</span>
            <span class="n">win</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
            <span class="n">win</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>


    <span class="c">#----------------------------------------------------------- Clipboard setup</span>
</div>
<div class="viewcode-block" id="SequenceFrame.setClipboardButtonStatus"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.SequenceFrame.setClipboardButtonStatus">[docs]</a>    <span class="k">def</span> <span class="nf">setClipboardButtonStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">paste</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the enabled state of the clipboard-related buttons.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cut : bool</span>
<span class="sd">            Whether the &#39;cut&#39; button should be enabled.</span>
<span class="sd">        copy : bool</span>
<span class="sd">            Whether the &#39;copy&#39; button should be enabled.</span>
<span class="sd">        paste : bool</span>
<span class="sd">            Whether the &#39;paste&#39; button should be enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cutButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">copyButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">copy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">paste</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pasteButton</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">paste</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
    <span class="k">def</span> <span class="nf">_createAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new action based on selections.&quot;&quot;&quot;</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">getSelection</span><span class="p">())</span>
        <span class="n">actionTuple</span> <span class="o">=</span> <span class="n">instrument</span><span class="o">.</span><span class="n">getActions</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()]</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">constructAction</span><span class="p">(</span><span class="n">actionTuple</span><span class="p">)</span>
        <span class="n">actionDialog</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">getDialog</span><span class="p">(</span><span class="n">action</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">actionDialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_beginDrag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle initiation of action dragging.&quot;&quot;&quot;</span>
        <span class="n">instrumentIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insts</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
        <span class="n">actionIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acts</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>

        <span class="n">dropData</span> <span class="o">=</span> <span class="n">DropData</span><span class="p">()</span>
        <span class="n">dropData</span><span class="o">.</span><span class="n">setObject</span><span class="p">((</span><span class="n">instrumentIndex</span><span class="p">,</span> <span class="n">actionIndex</span><span class="p">))</span>

        <span class="n">dropSource</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">DropSource</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dropSource</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">dropData</span><span class="p">)</span>
        <span class="n">dropSource</span><span class="o">.</span><span class="n">DoDragDrop</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onInterrupt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Interrupt a running loop.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">isInterrupted</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">ToggleTool</span><span class="p">(</span><span class="n">_ID_INTERRUPT</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">interruptLoop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">ToggleTool</span><span class="p">(</span><span class="n">_ID_INTERRUPT</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_enableInterrupt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable or disable the interrupt button.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="n">_ID_INTERRUPT</span><span class="p">,</span> <span class="n">enable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">ToggleTool</span><span class="p">(</span><span class="n">_ID_INTERRUPT</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>


<span class="c">#--------------------------------------------------------- Drag and drop storage</span>
</div>
<div class="viewcode-block" id="DropData"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.DropData">[docs]</a><span class="k">class</span> <span class="nc">DropData</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">CustomDataObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An object for storing data for drag-and-drop creation of actions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CustomDataObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CustomDataFormat</span><span class="p">(</span><span class="s">&quot;ActionDrop&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

<div class="viewcode-block" id="DropData.setObject"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.DropData.setObject">[docs]</a>    <span class="k">def</span> <span class="nf">setObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the information necessary to choose the correct action.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : tuple of int</span>
<span class="sd">            A tuple consisting of the two integers: the index of the correct</span>
<span class="sd">            instrument in experiment&#39;s list and the index of the correct</span>
<span class="sd">            action in the instrument&#39;s list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="DropData.getObject"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.DropData.getObject">[docs]</a>    <span class="k">def</span> <span class="nf">getObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the information necessary to construct the correct action.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        obj : tuple of int</span>
<span class="sd">            A tuple consisting of the two integers: the index of the correct</span>
<span class="sd">            instrument in experiment&#39;s list and the index of the correct</span>
<span class="sd">            action in the instrument&#39;s list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>


<span class="c">#---------------------------------------------------------- Drag and drop target</span>
</div></div>
<div class="viewcode-block" id="MyDropTarget"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget">[docs]</a><span class="k">class</span> <span class="nc">MyDropTarget</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">DropTarget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class to handle drop actions on the tree.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tree : ActionTree</span>
<span class="sd">        The tree into which actions may be dropped.</span>
<span class="sd">    acts : ListBox</span>
<span class="sd">        The list box of actions from which actions will be dragged.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">acts</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyDropTarget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">DropData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDataObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts</span> <span class="o">=</span> <span class="n">acts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_resetObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset the data objects.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">DropData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDataObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_saveSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Record the currently selected tree item(s).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_restoreSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reselect the previously selected tree item(s).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># pylint: disable=W0613,W0221,C0103</span>
<div class="viewcode-block" id="MyDropTarget.OnEnter"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget.OnEnter">[docs]</a>    <span class="k">def</span> <span class="nf">OnEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">defResult</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle the situation with the user drags something over the tree.</span>
<span class="sd">        </span>
<span class="sd">        When the user drags the right data type over the tree, unselect</span>
<span class="sd">        all tree items and save them to a list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_saveSelection</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">defResult</span>
</div>
<div class="viewcode-block" id="MyDropTarget.OnLeave"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget.OnLeave">[docs]</a>    <span class="k">def</span> <span class="nf">OnLeave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle the situation when the user drags something off the tree.</span>
<span class="sd">        </span>
<span class="sd">        When the user drags the data from the action list outside of the tree</span>
<span class="sd">        window, restore the items that were selected before the tree window</span>
<span class="sd">        was entered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restoreSelection</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MyDropTarget.OnDrop"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget.OnDrop">[docs]</a>    <span class="k">def</span> <span class="nf">OnDrop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reselect the previously selected items after data is dropped.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restoreSelection</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="MyDropTarget.OnDragOver"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget.OnDragOver">[docs]</a>    <span class="k">def</span> <span class="nf">OnDragOver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">defResult</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When data is dragged over a tree item, select that item.&quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">HitTest</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">item</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">selections</span> <span class="o">!=</span> <span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">selections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">defResult</span>
</div>
<div class="viewcode-block" id="MyDropTarget.OnData"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.MyDropTarget.OnData">[docs]</a>    <span class="k">def</span> <span class="nf">OnData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">defResult</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tell the tree to make the action.</span>
<span class="sd">        </span>
<span class="sd">        This method is called when `self.OnDrop` returns `True`. It tells the</span>
<span class="sd">        `ActionTree` to create the object based on the stored data tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetData</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">getObject</span><span class="p">()</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">HitTest</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">insertAction</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_resetObjects</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">defResult</span>
    <span class="c"># pylint: enable=W0613,W0221,C0103</span>


<span class="c">#----------------------------------------------------------- Action tree control</span>
</div></div>
<div class="viewcode-block" id="ActionTree"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree">[docs]</a><span class="k">class</span> <span class="nc">ActionTree</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TreeCtrl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A tree control for displaying experiment sequences.</span>
<span class="sd">    </span>
<span class="sd">    This subclass of wxTreeCtrl implements a number of features, including</span>
<span class="sd">    drag-and-drop and copy-and-paste while ensuring that the underlying </span>
<span class="sd">    experiment sequence remains in sync.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : wxWindow</span>
<span class="sd">        The panel or frame which contains this control.</span>
<span class="sd">    experiment : Experiment</span>
<span class="sd">        The experiment which manages the action sequence represented in this</span>
<span class="sd">        control.</span>
<span class="sd">    wxId : int</span>
<span class="sd">        The wxPython internal ID of this control.</span>
<span class="sd">    style : int</span>
<span class="sd">        The style for the control in terms of wx constants.</span>
<span class="sd">    parentFrame : ExperimentFrame</span>
<span class="sd">        The ExperimentFrame (or a derived class thereof) which contains this</span>
<span class="sd">        control.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">idnum</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span>
                 <span class="n">style</span><span class="o">=</span><span class="n">_DEFAULT_OPTIONS</span><span class="p">,</span> <span class="n">parentFrame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ActionTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">idnum</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experimentFrame</span> <span class="o">=</span> <span class="n">parentFrame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveData</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">activeItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddRoot</span><span class="p">(</span><span class="s">&#39;The Root Item&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getActionRoot</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIndent</span><span class="p">(</span><span class="n">_INDENT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endmarkFont</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">FONTFAMILY_DEFAULT</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">FONTSTYLE_ITALIC</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">FONTWEIGHT_NORMAL</span><span class="p">)</span>

        <span class="c"># Bind the event handlers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_ITEM_ACTIVATED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onDoubleClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_ITEM_RIGHT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onRightClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LEFT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onLeftClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_BEGIN_DRAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onBeginDrag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_END_DRAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onEndDrag</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ExpandAll</span><span class="p">()</span>

<div class="viewcode-block" id="ActionTree.buildDefaultTree"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.buildDefaultTree">[docs]</a>    <span class="k">def</span> <span class="nf">buildDefaultTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill a tree with default values. </span>
<span class="sd">        </span>
<span class="sd">        Currently, the values are for testing purposes only and are not</span>
<span class="sd">        really useful. For the final, working version, everything except</span>
<span class="sd">        the set filename action will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">normalizePath</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;/Desktop&#39;</span><span class="p">)</span>
        <span class="n">inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">actSetFile</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">getAction</span><span class="p">(</span><span class="s">&#39;set_file&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">actSetFile</span><span class="o">.</span><span class="n">setInputValues</span><span class="p">([</span><span class="n">location</span><span class="p">,</span> <span class="s">r&#39;testing&#39;</span><span class="p">,</span> <span class="s">r&#39;Auto&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">actSetFile</span><span class="p">)</span>

        <span class="n">nameRange1</span> <span class="o">=</span> <span class="s">&quot;Item 0&quot;</span>
        <span class="n">actRange1</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">getAction</span><span class="p">(</span><span class="s">&#39;scan_num&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">actRange1</span><span class="o">.</span><span class="n">setInputValues</span><span class="p">([[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]])</span>
        <span class="n">actRange1</span><span class="o">.</span><span class="n">setInputColumns</span><span class="p">([</span><span class="n">nameRange1</span><span class="p">])</span>
        <span class="n">actRange2</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">getAction</span><span class="p">(</span><span class="s">&#39;scan_num&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">actRange2</span><span class="o">.</span><span class="n">setInputValues</span><span class="p">([[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]])</span>
        <span class="n">actRange2</span><span class="o">.</span><span class="n">setInputColumns</span><span class="p">([</span><span class="s">&#39;AnotherNumber&#39;</span><span class="p">])</span>
        <span class="n">actRange1</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">actRange2</span><span class="p">)</span>
        <span class="n">actCalc</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">getAction</span><span class="p">(</span><span class="s">&#39;calculate&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">actCalc</span><span class="o">.</span><span class="n">setInputValues</span><span class="p">([</span><span class="s">&#39;3*#(Item 0)&#39;</span><span class="p">])</span>
        <span class="n">actRange2</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">actCalc</span><span class="p">)</span>
        <span class="n">actWait</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">getAction</span><span class="p">(</span><span class="s">&#39;wait&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">actWait</span><span class="o">.</span><span class="n">setInputValues</span><span class="p">([</span><span class="o">.</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">actRange2</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">actWait</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">actRange1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpandAll</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.refresh"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill in the entire tree from the experiment&#39;s action sequence.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DeleteChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_buildSubtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">lastChild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetLastChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">lastChild</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">lastChild</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ActionTree.getItemAtPosition"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.getItemAtPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getItemAtPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the item at a position under a specified parent.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The parent under which the desired item is located.</span>
<span class="sd">        index : int</span>
<span class="sd">            The position of the item to get.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wxTreeItemId</span>
<span class="sd">            The item at the specified position, or `None` if the position</span>
<span class="sd">            is out of range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildrenCount</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
            <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">currentIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">currentIndex</span> <span class="o">==</span> <span class="n">index</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">child</span>
                <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ActionTree.getItemPosition"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.getItemPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getItemPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the position of an item within its list of siblings.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The parent of the item in question.</span>
<span class="sd">        item : wxTreeItemId</span>
<span class="sd">            The item whose position is sought.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The position of `item` in the list of children of `parentItem`. If</span>
<span class="sd">            `item` is not a child of `parentItem`, then `None` is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildrenCount</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">currentIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">child</span> <span class="ow">is</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">currentIndex</span>
            <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>


    <span class="c">#===========================================================================</span>
    <span class="c"># Action and item insertion</span>
    <span class="c">#===========================================================================</span>
</div>
    <span class="k">def</span> <span class="nf">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">skipCore</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append an action to a sub-tree.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The item to which the new action should be appended.</span>
<span class="sd">        action : Action</span>
<span class="sd">            The action which should be appended.</span>
<span class="sd">        skipCore : bool</span>
<span class="sd">            Whether to skip operations on `Action` objects (from the `core`</span>
<span class="sd">            package). This should be `True` when `action` is already formed</span>
<span class="sd">            (for instance, when creating a GUI tree branch from an existing</span>
<span class="sd">            `Action` tree, as is done by the `_buildSubtree` method).</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wxTreeItem</span>
<span class="sd">            The newly created and appended item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AppendItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="n">parentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skipCore</span><span class="p">:</span>
            <span class="n">parentAction</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buildSubtree</span><span class="p">(</span><span class="n">newItem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newItem</span>

    <span class="k">def</span> <span class="nf">_insertActionAtItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">,</span> <span class="n">posItem</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">skipCore</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert an action before a specified item.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The item under which to insert the new item.</span>
<span class="sd">        posItem : wxTreeItemId</span>
<span class="sd">            The item indicating the position where the new item should be</span>
<span class="sd">            inserted (i.e. the item which should be immediately **after** the</span>
<span class="sd">            new item once it has been inserted).</span>
<span class="sd">        action : Action</span>
<span class="sd">            The action to add to the branch.</span>
<span class="sd">        skipCore : bool</span>
<span class="sd">            Whether to skip operations on `Action` objects (from the `core`</span>
<span class="sd">            package). This should be `True` when `action` is already formed</span>
<span class="sd">            (for instance, when creating a GUI tree branch from an existing</span>
<span class="sd">            `Action` tree, as is done by the `_buildSubtree` method).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wxTreeItemId</span>
<span class="sd">            The item which has been added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newItemText</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">posItem</span><span class="p">:</span>
            <span class="n">newItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PrependItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">newItemText</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">previousItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPrevSibling</span><span class="p">(</span><span class="n">posItem</span><span class="p">)</span>
            <span class="n">newItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InsertItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">previousItem</span><span class="p">,</span> <span class="n">newItemText</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skipCore</span><span class="p">:</span>
            <span class="n">parentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
            <span class="n">posAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">posItem</span><span class="p">)</span>
            <span class="n">parentAction</span><span class="o">.</span><span class="n">insertChildBefore</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">posAction</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">newItem</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buildSubtree</span><span class="p">(</span><span class="n">newItem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newItem</span>

    <span class="k">def</span> <span class="nf">_buildSubtree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recursively Construct a sub-tree under a specified item.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The tree item whose sub-tree should be constructed.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of wxTreeItemId</span>
<span class="sd">            The new items created for the subtree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newChildren</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">auxBuildSubtree</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Help build the subtree.&quot;&quot;&quot;</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildrenCount</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DeleteChildren</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">)</span>
            <span class="n">nodeAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nodeAction</span><span class="o">.</span><span class="n">allowsChildren</span><span class="p">():</span>
                <span class="n">children</span> <span class="o">=</span> <span class="n">nodeAction</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                    <span class="n">newItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                    <span class="n">newChildren</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newItem</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendEndMark</span><span class="p">(</span><span class="n">nodeItem</span><span class="p">)</span>
        <span class="n">auxBuildSubtree</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpandAll</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">_PRINT_SEQUENCE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getActionRoot</span><span class="p">()</span><span class="o">.</span><span class="n">printme</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newChildren</span>

    <span class="k">def</span> <span class="nf">_appendEndMark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentItem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append an end-of-container marker.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parentItem : wxTreeItemId</span>
<span class="sd">            The item for the container whose last item should be the end</span>
<span class="sd">            marker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newMark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AppendItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="s">&#39;-----------------&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">newMark</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
        <span class="c"># self.SetItemFont(newMark, self.endmarkFont)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">newMark</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>


    <span class="c">#===========================================================================</span>
    <span class="c"># Clipboard control (copy/paste)</span>
    <span class="c">#===========================================================================</span>

<div class="viewcode-block" id="ActionTree.clearClipboard"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.clearClipboard">[docs]</a>    <span class="k">def</span> <span class="nf">clearClipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear the clipboard, trashing its contents.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;cut&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">trash</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ActionTree.cutAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.cutAction">[docs]</a>    <span class="k">def</span> <span class="nf">cutAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cut an item from the tree to the clipboard.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : wxTreeItemId</span>
<span class="sd">            The item to cut from the tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearClipboard</span><span class="p">()</span>
        <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">parentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">parentAction</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;cut&#39;</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.copyAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.copyAction">[docs]</a>    <span class="k">def</span> <span class="nf">copyAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy an item from the tree to the clipboard.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : wxTreeItemId</span>
<span class="sd">            The item to copy from the tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearClipboard</span><span class="p">()</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;copy&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ActionTree.pasteAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.pasteAction">[docs]</a>    <span class="k">def</span> <span class="nf">pasteAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste an item from the clipboard onto the tree.</span>
<span class="sd">                </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : wx.TreeItemId</span>
<span class="sd">            The tree item before which to paste the clipboard&#39;s contents.</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        At the end of this operation, the clipboard&#39;s `operation` flag is</span>
<span class="sd">        always &#39;copy&#39;, and its `action` is always a clone of whatever action</span>
<span class="sd">        was originally put there. That way, the user can continue to do paste</span>
<span class="sd">        operations even if the clipboard was filled using a cut (and clones</span>
<span class="sd">        do not need to be trashed, since they were never instantiated in the</span>
<span class="sd">        first place).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendEndMark</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_insertActionAtItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;copy&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_updateClipboardStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the active item and the clipboard buttons.&quot;&quot;&quot;</span>
        <span class="n">paste</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activeItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experimentFrame</span><span class="o">.</span><span class="n">setClipboardButtonStatus</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">paste</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activeItem</span> <span class="o">=</span> <span class="n">item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experimentFrame</span><span class="o">.</span><span class="n">setClipboardButtonStatus</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">paste</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activeItem</span> <span class="o">=</span> <span class="n">item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experimentFrame</span><span class="o">.</span><span class="n">setClipboardButtonStatus</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">paste</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_traverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">startNode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply a function recursively to all children of an action.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : function</span>
<span class="sd">            The function to apply to each node in the sub-tree.</span>
<span class="sd">        startNode : wx.TreeItem</span>
<span class="sd">            The parent to which, and to whose children, the function should be</span>
<span class="sd">            applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">traverseAux</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Traverse the sub-elements of the current node.&quot;&quot;&quot;</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildrenCount</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
                <span class="n">func</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
                <span class="n">traverseAux</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
                <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
        <span class="n">func</span><span class="p">(</span><span class="n">startNode</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">traverseAux</span><span class="p">(</span><span class="n">startNode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_itemIsChildOf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potentialDescendant</span><span class="p">,</span> <span class="n">ancestor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether one item is a child of another.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        potentialDescendant : wx.TreeItem</span>
<span class="sd">            The item whose ancestry to check.</span>
<span class="sd">        ancestor : wx.TreeItem</span>
<span class="sd">            The item which might be an ancestor of `potentialDescendant`.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            `True` if `potentialDescendant` is in fact a descendant of</span>
<span class="sd">            `ancestor`, or `False` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">_testFunction</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Return whether a node is the desired descendant.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">potentialDescendant</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_traverse</span><span class="p">(</span><span class="n">_testFunction</span><span class="p">,</span> <span class="n">ancestor</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_onBeginDrag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Respond to drag start: record the item being dragged.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wxTreeEvent</span>
<span class="sd">            The TreeEvent which contains the object to be moved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Allow</span><span class="p">()</span>
        <span class="n">eventItem</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">eventItem</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moveData</span> <span class="o">=</span> <span class="n">eventItem</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moveData</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_onEndDrag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Respond to drag end: move the item being dragged.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moveData</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span><span class="o">.</span><span class="n">IsOk</span><span class="p">():</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_itemIsChildOf</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moveData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Unselect</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">moveAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moveData</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onLeftClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Respond to left click: select item.&quot;&quot;&quot;</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>
        <span class="n">item</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HitTest</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_NOWHERE</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updateClipboardStatus</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateClipboardStatus</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_onRightClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Respond to right click: show context menu.&quot;&quot;&quot;</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateClipboardStatus</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">editAction</span><span class="p">(</span><span class="n">eventSub</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Edit the selected action.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editAction</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">editInstrument</span><span class="p">(</span><span class="n">eventSub</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Edit the instrument bound to the selected action.&quot;&quot;&quot;</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">instdialog</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">RebindInstrumentDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span>
                                                   <span class="n">action</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">instdialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">instdialog</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">deleteAction</span><span class="p">(</span><span class="n">eventSub</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Delete the selected action.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteAction</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="n">menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CUT</span><span class="p">,</span> <span class="s">&#39;Cut&#39;</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span><span class="p">,</span> <span class="s">&#39;Copy&#39;</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span><span class="p">,</span> <span class="s">&#39;Paste&#39;</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_EDIT</span><span class="p">,</span> <span class="s">&#39;Edit action&#39;</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_DELETE</span><span class="p">,</span> <span class="s">&#39;Delete action&#39;</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">_ID_REBIND</span><span class="p">,</span> <span class="s">&#39;Change instrument&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CUT</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_EDIT</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_DELETE</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">_ID_REBIND</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">_ID_ENABLE</span><span class="p">,</span> <span class="s">&#39;Disable action&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">_ID_ENABLE</span><span class="p">,</span> <span class="s">&#39;Enable action&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CUT</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_EDIT</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_DELETE</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">_ID_REBIND</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">_ID_ENABLE</span><span class="p">,</span> <span class="s">&#39;Enable action&#39;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">_ID_ENABLE</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clipboard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCut</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CUT</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCopy</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPaste</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="n">editAction</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_EDIT</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="n">deleteAction</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_DELETE</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="n">editInstrument</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">_ID_REBIND</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEnable</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">_ID_ENABLE</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onDoubleClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Respond to double click: edit the action.&quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editAction</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<div class="viewcode-block" id="ActionTree.onEnable"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.onEnable">[docs]</a>    <span class="k">def</span> <span class="nf">onEnable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable or disable the selected item.&quot;&quot;&quot;</span>
        <span class="n">toEnable</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">enableAux</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dummy</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Do something.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">currentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">currentAction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">currentAction</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">toEnable</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">action</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
                    <span class="n">toEnable</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_traverse</span><span class="p">(</span><span class="n">enableAux</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.enableTree"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.enableTree">[docs]</a>    <span class="k">def</span> <span class="nf">enableTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the color of a tree of actions based on the top.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">enable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemTextColour</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
        <span class="n">childrenCount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildrenCount</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">childrenCount</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enableTree</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">enable</span><span class="p">)</span>
            <span class="n">child</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ActionTree.onCut"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.onCut">[docs]</a>    <span class="k">def</span> <span class="nf">onCut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cut the item from the tree (pass the work to the tree).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ActionTree.onCopy"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.onCopy">[docs]</a>    <span class="k">def</span> <span class="nf">onCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the selected item (pass the work to the tree).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ActionTree.onPaste"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.onPaste">[docs]</a>    <span class="k">def</span> <span class="nf">onPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste an item into the tree (pass the work to the tree).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ActionTree.addAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.addAction">[docs]</a>    <span class="k">def</span> <span class="nf">addAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an action to the end of the tree.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        action : Action</span>
<span class="sd">            The action to add to the end of the tree (at the highest level).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.insertAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.insertAction">[docs]</a>    <span class="k">def</span> <span class="nf">insertAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actionTuple</span><span class="p">,</span> <span class="n">targetItem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert an action above the specified item.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        actionTuple : tuple of int </span>
<span class="sd">            A tuple consisting of two integers. The first should be the index</span>
<span class="sd">            of the instrument in the experiment&#39;s list. The second should be</span>
<span class="sd">            the index of the action within the instrument&#39;s list.</span>
<span class="sd">        targetItem : wxTreeItemId</span>
<span class="sd">            The tree item above which the new action should be added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="n">actionTuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">actionSpec</span> <span class="o">=</span> <span class="n">instrument</span><span class="o">.</span><span class="n">getActions</span><span class="p">()[</span><span class="n">actionTuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">constructAction</span><span class="p">(</span><span class="n">actionSpec</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">targetItem</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">targetItem</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">getDialog</span><span class="p">(</span><span class="n">action</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">targetParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="n">targetParent</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_appendEndMark</span><span class="p">(</span><span class="n">targetParent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">targetParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_insertActionAtItem</span><span class="p">(</span><span class="n">targetParent</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.editAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.editAction">[docs]</a>    <span class="k">def</span> <span class="nf">editAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit the selected action.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : wxTreeItemId</span>
<span class="sd">            The item whose action the user wants to edit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">getDialog</span><span class="p">(</span><span class="n">action</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="n">actionIn</span><span class="o">=</span><span class="n">action</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.moveAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.moveAction">[docs]</a>    <span class="k">def</span> <span class="nf">moveAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourceItem</span><span class="p">,</span> <span class="n">targetItem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move the item and its action from one place to another.</span>
<span class="sd">        </span>
<span class="sd">        Essentially, this is just a cut and paste operation rolled into one,</span>
<span class="sd">        allowing for drag-and-drop move operations without messing with the</span>
<span class="sd">        clipboard.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sourceItem : wxTreeItemId</span>
<span class="sd">            The item which is to be moved.</span>
<span class="sd">        targetItem : wxTreeItemId</span>
<span class="sd">            The item before which `sourceItem` should be placed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearClipboard</span><span class="p">()</span>
        <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">sourceItem</span><span class="p">)</span>
        <span class="n">parentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">sourceItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">sourceItem</span><span class="p">)</span>
        <span class="n">parentAction</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">targetItem</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">targetItem</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">targetItem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">targetItem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_appendAction</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_appendEndMark</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">targetItem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_insertActionAtItem</span><span class="p">(</span><span class="n">parentItem</span><span class="p">,</span> <span class="n">targetItem</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
<span class="c">#         self.clipboard = (&#39;copy&#39;, action.clone())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.deleteAction"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.deleteAction">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete the action contained within a given tree item.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : wxTreeItemId</span>
<span class="sd">            The tree item which should be deleted, along with its associated</span>
<span class="sd">            action and all of their children.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">parentAction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="n">parentAction</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">trash</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ActionTree.flagEdit"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ActionTree.flagEdit">[docs]</a>    <span class="k">def</span> <span class="nf">flagEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Indicate that the sequence has been edited.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experimentFrame</span><span class="o">.</span><span class="n">flagEdit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Parent frame has no method flagEdit&#39;</span><span class="p">)</span>


<span class="c">#--------------------------------------------------------------- InstrumentFrame</span>
</div></div>
<div class="viewcode-block" id="InstrumentFrame"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame">[docs]</a><span class="k">class</span> <span class="nc">InstrumentFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A frame for configuring the instruments in an experiment.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : wx.Window</span>
<span class="sd">        The panel or frame which contains this instrument frame.</span>
<span class="sd">    experiment : Experiment</span>
<span class="sd">        The experiment whose instruments should be modified by this frame.</span>
<span class="sd">    successAction : Command or list of Command</span>
<span class="sd">        The action or actions to perform when the instruments are updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">successAction</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an instrument frame.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InstrumentFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span>
                                              <span class="n">title</span><span class="o">=</span><span class="s">&#39;Instrument Manager&#39;</span><span class="p">,</span>
                                              <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="k">if</span> <span class="n">successAction</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="n">successAction</span>

        <span class="n">mainpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">)</span>

        <span class="n">instpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">instpanel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[],</span>
                                        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">LB_SINGLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LB_ALWAYS_SB</span><span class="p">)</span>
        <span class="n">instpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LISTBOX_DCLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LISTBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSelection</span><span class="p">)</span>

        <span class="n">additionpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="n">additionpanel</span><span class="o">.</span><span class="n">addLabel</span><span class="p">(</span><span class="s">&#39;Instrument to add:&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentOptions</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">additionpanel</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[],</span>
                                             <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="p">)</span>
        <span class="n">additionpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentOptions</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">buttonpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Add&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onAdd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Edit&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Remove&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onRemove</span><span class="p">)</span>

        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">instpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">additionpanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">buttonpanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_HORIZONTAL</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getInstrumentsIconIcon</span><span class="p">())</span>

        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizeHints</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>

<div class="viewcode-block" id="InstrumentFrame.populate"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.populate">[docs]</a>    <span class="k">def</span> <span class="nf">populate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill the available and included instruments boxes.&quot;&quot;&quot;</span>
        <span class="n">instrumentStrings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrumentStrings</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">availableStrings</span> <span class="o">=</span> <span class="n">INSTRUMENT_MANAGER</span><span class="o">.</span><span class="n">getAvailableInstrumentStrings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">SetItems</span><span class="p">(</span><span class="n">instrumentStrings</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentOptions</span><span class="o">.</span><span class="n">SetItems</span><span class="p">(</span><span class="n">availableStrings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentOptions</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.updateButtonEnabled"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.updateButtonEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">updateButtonEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable and disable buttons based on selections.&quot;&quot;&quot;</span>
        <span class="n">isel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">isel</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">GetItems</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.onAdd"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.onAdd">[docs]</a>    <span class="k">def</span> <span class="nf">onAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new instrument.&quot;&quot;&quot;</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentOptions</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">()</span>
        <span class="n">newInstrument</span> <span class="o">=</span> <span class="n">INSTRUMENT_MANAGER</span><span class="o">.</span><span class="n">constructInstrument</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">)</span>
        <span class="n">instrumentDialog</span> <span class="o">=</span> <span class="n">InstrumentDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newInstrument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">instrumentDialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">addInstrument</span><span class="p">(</span><span class="n">newInstrument</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.onEdit"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.onEdit">[docs]</a>    <span class="k">def</span> <span class="nf">onEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit the selected instrument.&quot;&quot;&quot;</span>
        <span class="n">selectionIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="n">selectionIndex</span><span class="p">)</span>
        <span class="n">instrumentDialog</span> <span class="o">=</span> <span class="n">InstrumentDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">instrumentDialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.onRemove"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.onRemove">[docs]</a>    <span class="k">def</span> <span class="nf">onRemove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the selected instrument.&quot;&quot;&quot;</span>
        <span class="n">localsel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentBox</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">(</span><span class="n">localsel</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">removeInstrument</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InstrumentInUseError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">wrapper</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
            <span class="n">txt0</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;The instrument is still in use. The following actions &#39;</span>
                    <span class="s">&#39;must be bound to some other instrument or deleted &#39;</span>
                    <span class="s">&#39;before this instrument can be deleted:&#39;</span><span class="p">)</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">txt0</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="n">wrapper</span><span class="o">.</span><span class="n">initial_indent</span> <span class="o">=</span> <span class="s">&#39;  &#39;</span>
            <span class="n">wrapper</span><span class="o">.</span><span class="n">subsequent_indent</span> <span class="o">=</span> <span class="s">&#39;      &#39;</span>
            <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">+=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">act</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="s">&#39;Cannot delete instrument&#39;</span><span class="p">,</span>
                                      <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.executeSuccessActions"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.executeSuccessActions">[docs]</a>    <span class="k">def</span> <span class="nf">executeSuccessActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute any success actions.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">successAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span><span class="p">:</span>
            <span class="n">successAction</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.onSelection"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.onSelection">[docs]</a>    <span class="k">def</span> <span class="nf">onSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the buttons to reflect selections.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="InstrumentFrame.onClose"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.InstrumentFrame.onClose">[docs]</a>    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>


<span class="c">#------------------------------------------------------------------- Graph Frame</span>
</div></div>
<div class="viewcode-block" id="GraphFrame"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame">[docs]</a><span class="k">class</span> <span class="nc">GraphFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A frame for setting the graphs which the owning experiment will create.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : wx.Window</span>
<span class="sd">        The panel or frame which contains this graph frame.</span>
<span class="sd">    experiment : Experiment</span>
<span class="sd">        The experiment whose graphs should be modified by this frame.</span>
<span class="sd">    successAction : list of Command</span>
<span class="sd">        The action or actions to perform when the graphs are updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">successAction</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GraphFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Graph Manager&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span> <span class="o">=</span> <span class="n">experiment</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graphData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getGraphStringsAndStates</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">successAction</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="n">successAction</span>

        <span class="n">mainpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">graphpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">graphpanel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[],</span>
                                 <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">LB_SINGLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LB_ALWAYS_SB</span><span class="p">)</span>
        <span class="n">graphpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LISTBOX_DCLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LISTBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSelection</span><span class="p">)</span>

        <span class="n">buttonpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Add&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onAdd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Edit&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Remove&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onRemove</span><span class="p">)</span>

        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">buttonpanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_HORIZONTAL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getGraphsIconIcon</span><span class="p">())</span>

        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizeHints</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>

<div class="viewcode-block" id="GraphFrame.populate"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.populate">[docs]</a>    <span class="k">def</span> <span class="nf">populate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill the list of graphs.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getGraphStringsAndStates</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">SetItems</span><span class="p">([</span><span class="n">datum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphData</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphData</span><span class="p">):</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">enabled</span> <span class="o">=</span> <span class="n">datum</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">enabled</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">SetItemForegroundColour</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">SetString</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39; (disabled)&#39;</span><span class="p">)</span>

        <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphData</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.onAdd"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.onAdd">[docs]</a>    <span class="k">def</span> <span class="nf">onAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new graph.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkAbility</span><span class="p">():</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">GraphDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.onEdit"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.onEdit">[docs]</a>    <span class="k">def</span> <span class="nf">onEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit an existing graph.&quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getGraph</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">GraphDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="p">,</span> <span class="n">selected</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.onRemove"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.onRemove">[docs]</a>    <span class="k">def</span> <span class="nf">onRemove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete an existing graph.&quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getGraph</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">removeGraph</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.executeSuccessActions"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.executeSuccessActions">[docs]</a>    <span class="k">def</span> <span class="nf">executeSuccessActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute any success actions.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">successAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span><span class="p">:</span>
            <span class="n">successAction</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.updateButtonEnabled"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.updateButtonEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">updateButtonEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable or disable buttons based on current selection.&quot;&quot;&quot;</span>
        <span class="n">isel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">isel</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">GetItems</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GraphFrame.checkAbility"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.checkAbility">[docs]</a>    <span class="k">def</span> <span class="nf">checkAbility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether there are enough columns to create a graph.&quot;&quot;&quot;</span>
        <span class="n">columnNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getStorageBinNames</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columnNames</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">((</span><span class="s">&#39;A graph cannot be created at this time. &#39;</span>
                           <span class="s">&#39;You must have at least two columns &#39;</span>
                           <span class="s">&#39;defined in order to graph things.&#39;</span><span class="p">),</span>
                          <span class="s">&#39;Cannot create graph.&#39;</span><span class="p">,</span>
                          <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="GraphFrame.onSelection"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.onSelection">[docs]</a>    <span class="k">def</span> <span class="nf">onSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the buttons to reflect selections.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateButtonEnabled</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GraphFrame.onClose"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.GraphFrame.onClose">[docs]</a>    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>


<span class="c">#----------------------------------------------------------------- ConstantFrame</span>
</div></div>
<div class="viewcode-block" id="ConstantFrame"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame">[docs]</a><span class="k">class</span> <span class="nc">ConstantFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A frame for setting the constants which the owning experiment can use.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : wx.Window</span>
<span class="sd">        The panel or frame which contains this constant frame.</span>
<span class="sd">    experiment : Experiment</span>
<span class="sd">        The experiment whose constants should be modified by this frame.</span>
<span class="sd">    successAction : Command or list of Command</span>
<span class="sd">        The action or actions to perform when the constants are updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">successAction</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ConstantFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="k">if</span> <span class="n">successAction</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span> <span class="o">=</span> <span class="n">successAction</span>

        <span class="n">mainpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">headerlist</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Name&#39;</span><span class="p">,</span> <span class="s">&#39;Value&#39;</span><span class="p">]</span>
        <span class="n">formatlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">LIST_FORMAT_LEFT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIST_FORMAT_RIGHT</span><span class="p">]</span>
        <span class="n">listpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">StaticListCtrl</span><span class="p">(</span><span class="n">listpanel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">headerlist</span><span class="p">,</span>
                                           <span class="n">formatlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LIST_ITEM_SELECTED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSelection</span><span class="p">)</span>
        <span class="n">listpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">settingspanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;flex_grid&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">settingspanel</span><span class="o">.</span><span class="n">addGrowableColumn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">settingspanel</span><span class="o">.</span><span class="n">addGrowableColumn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">settingspanel</span><span class="o">.</span><span class="n">addLabeledText</span><span class="p">(</span><span class="s">&#39;Name:&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">settingspanel</span><span class="o">.</span><span class="n">addLabeledText</span><span class="p">(</span><span class="s">&#39;Value:&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEdit</span><span class="p">)</span>

        <span class="n">buttonpanel</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Add&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onAdd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Set&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onSave</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Remove&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onRemove</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span> <span class="o">=</span> <span class="n">buttonpanel</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="s">&#39;Clear&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">onClear</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">listpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">settingspanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mainpanel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">buttonpanel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_HORIZONTAL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getConstantsIconIcon</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>

        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mainpanel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizeHints</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>

<div class="viewcode-block" id="ConstantFrame.populate"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.populate">[docs]</a>    <span class="k">def</span> <span class="nf">populate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the constants (names and values) from the experiment.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DeleteAllItems</span><span class="p">()</span>
        <span class="n">constants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getAllConstants</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">currentName</span> <span class="ow">in</span> <span class="n">constants</span><span class="p">:</span>
            <span class="n">currentValue</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">constants</span><span class="p">[</span><span class="n">currentName</span><span class="p">])</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetItemCount</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">InsertStringItem</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">currentName</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">SetStringItem</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">currentValue</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstantFrame.executeSuccessActions"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.executeSuccessActions">[docs]</a>    <span class="k">def</span> <span class="nf">executeSuccessActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute any success actions which have been defined.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">successAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">successAction</span><span class="p">:</span>
            <span class="n">successAction</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onAdd"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onAdd">[docs]</a>    <span class="k">def</span> <span class="nf">onAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new constant with the entered name and value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkValue</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">numItems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetItemCount</span><span class="p">()</span>
        <span class="n">newName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">newValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">InsertStringItem</span><span class="p">(</span><span class="n">numItems</span><span class="p">,</span> <span class="n">newName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">SetStringItem</span><span class="p">(</span><span class="n">numItems</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newValue</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">setConstant</span><span class="p">(</span><span class="n">newName</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselectAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onRemove"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onRemove">[docs]</a>    <span class="k">def</span> <span class="nf">onRemove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the selected constant.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetFocusedItem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">removeConstant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DeleteItem</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselectAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onClear"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onClear">[docs]</a>    <span class="k">def</span> <span class="nf">onClear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear the name and value controls.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselectAll</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onSave"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onSave">[docs]</a>    <span class="k">def</span> <span class="nf">onSave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the value if it is legitimate.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkValue</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetFocusedItem</span><span class="p">()</span>
        <span class="n">newName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">newValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">setConstant</span><span class="p">(</span><span class="n">newName</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DeleteItem</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">InsertStringItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">newName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">SetStringItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselectAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executeSuccessActions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.deselectAll"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.deselectAll">[docs]</a>    <span class="k">def</span> <span class="nf">deselectAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deselect all items in the list.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetItemCount</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onEdit"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onEdit">[docs]</a>    <span class="k">def</span> <span class="nf">onEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update buttons based on the contents of the controls.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">nameLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="n">valueLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">nameLength</span> <span class="o">==</span> <span class="n">valueLength</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">nameLength</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">valueLength</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getConstant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnClear</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onSelection"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onSelection">[docs]</a>    <span class="k">def</span> <span class="nf">onSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update buttons and values as the list selection changes.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetFocusedItem</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetFocusedItem</span><span class="p">()</span>
            <span class="n">selectedName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">selectedName</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getConstant</span><span class="p">(</span><span class="n">selectedName</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btnRemove</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnAdd</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btnSet</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ConstantFrame.checkValue"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.checkValue">[docs]</a>    <span class="k">def</span> <span class="nf">checkValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make sure the entered value is legitimate.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&#39;Constant value must be a number.&#39;</span><span class="p">,</span> <span class="s">&#39;Error&#39;</span><span class="p">,</span>
                          <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;[^a-zA-Z]&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()):</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&#39;Constant name must begin with a letter&#39;</span><span class="p">,</span> <span class="s">&#39;Error&#39;</span><span class="p">,</span>
                          <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;[^a-zA-Z0-9]&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()):</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&#39;Constant name may not contain special characters.&#39;</span><span class="p">,</span>
                          <span class="s">&#39;Error&#39;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="ConstantFrame.onClose"><a class="viewcode-back" href="../../../../api_gui_main_expt_editor.html#src.gui.main.expt_editor.ConstantFrame.onClose">[docs]</a>    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Transport Experiment 1.5.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Thomas C. Flanagan.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>